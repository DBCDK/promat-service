#!/usr/bin/env bash

source "$(realpath $(dirname "${0}")/..)/scripts/common"

docker run -ti --rm --name "${DOCKER_NAME}-${PORT}" \
  -e JAVA_MAX_HEAP_SIZE=${JAVA_MAX_HEAP_SIZE} \
  -e PROMAT_DB_URL=${PROMAT_DB_URL} \
  -e CULR_SERVICE_URL=${CULR_SERVICE_URL} \
  -e CULR_SERVICE_USER_ID=${CULR_SERVICE_USER_ID} \
  -e CULR_SERVICE_PASSWORD=${CULR_SERVICE_PASSWORD} \
  -e OPENSEARCH_SERVICE_URL=${OPENSEARCH_SERVICE_URL} \
  -e OPENSEARCH_PROFILE=${OPENSEARCH_PROFILE} \
  -e OPENSEARCH_AGENCY=${OPENSEARCH_AGENCY} \
  -e OPENSEARCH_REPOSITORY=${OPENSEARCH_REPOSITORY} \
  -e WORK_PRESENTATION_SERVICE_URL=${WORK_PRESENTATION_SERVICE_URL} \
  -e WORK_PRESENTATION_PROFILE=${WORK_PRESENTATION_PROFILE} \
  -e PROMAT_CLUSTER_NAME=${PROMAT_CLUSTER_NAME} \
  -e MAIL_HOST=${MAIL_HOST} \
  -e MAIL_USER=${MAIL_USER} \
  -e MAIL_FROM=${MAIL_FROM} \
  -e PROMAT_AGENCY_ID=${PROMAT_AGENCY_ID} \
  -e OPENFORMAT_SERVICE_URL=${OPENFORMAT_SERVICE_URL} \
  -e LU_MAILADDRESS=${LU_MAILADDRESS} \
  -e MP_OPENAPI_SERVERS=${MP_OPENAPI_SERVERS} \
  -e OPENAPI_UI_CONTEXTROOT=${OPENAPI_UI_CONTEXTROOT} \
  -e OPENNUMBERROLL_SERVICE_URL=${OPENNUMBERROLL_SERVICE_URL} \
  -e OPENNUMBERROLL_NUMBERROLLNAME=${OPENNUMBERROLL_NUMBERROLLNAME} \
  -e ENABLE_REMINDERS=${ENABLE_REMINDERS} \
  -e EMATERIAL_CONTENT_REPO=${EMATERIAL_CONTENT_REPO} \
  -e OAUTH2_CLIENT_ID=${OAUTH2_CLIENT_ID} \
  -e OAUTH2_CLIENT_SECRET=${OAUTH2_CLIENT_SECRET} \
  -e OAUTH2_INTROSPECTION_URL=${OAUTH2_INTROSPECTION_URL} \
  -e LOG_FORMAT=${LOG_FORMAT} \
  -p "${PORT}:8080" \
  $@ \
  "${DOCKER_REPOSITORY}:devel"
